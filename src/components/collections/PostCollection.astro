---
import { getCollection } from 'astro:content'
import PostCard from '../cards/PostCard.astro'

type Props = {
  selection?: string[]
  limit?: number
}

const { selection, limit } = Astro.props

const posts = (await getCollection('posts'))
  .map(post => ({
    slug: post.slug,
    title: post.data.title,
    icon: post.data.icon,
    date: post.data.date,
    tags: post.data.tags,
  }))
  .filter(post => (selection ?? [post.slug]).includes(post.slug))
  .sort((post1, post2) => {
    if (post1.date > post2.date) return -1
    if (post1.date < post2.date) return +1
    return 0
  })
  .slice(0, limit)
---

<section class="my-8 flex flex-col gap-4">
  {posts.map(post => <PostCard slug={post.slug} title={post.title} icon={post.icon} date={post.date} />)}
</section>
